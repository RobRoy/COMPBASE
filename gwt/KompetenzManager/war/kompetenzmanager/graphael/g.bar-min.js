/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
var mmin=Math.min,mmax=Math.max;function finger(i,g,b,j,d,e,f,c){var l,h={round:"round",sharp:"sharp",soft:"soft",square:"square"};if((d&&!j)||(!d&&!b)){return f?"":c.path()}e=h[e]||"square";j=Math.round(j);b=Math.round(b);i=Math.round(i);g=Math.round(g);switch(e){case"round":if(!d){var a=~~(j/2);if(b<a){a=b;l=["M",i+0.5,g+0.5-~~(j/2),"l",0,0,"a",a,~~(j/2),0,0,1,0,j,"l",0,0,"z"]}else{l=["M",i+0.5,g+0.5-a,"l",b-a,0,"a",a,a,0,1,1,0,j,"l",a-b,0,"z"]}}else{a=~~(b/2);if(j<a){a=j;l=["M",i-~~(b/2),g,"l",0,0,"a",~~(b/2),a,0,0,1,b,0,"l",0,0,"z"]}else{l=["M",i-a,g,"l",0,a-j,"a",a,a,0,1,1,b,0,"l",0,j-a,"z"]}}break;case"sharp":if(!d){var k=~~(j/2);l=["M",i,g+k,"l",0,-j,mmax(b-k,0),0,mmin(k,b),k,-mmin(k,b),k+(k*2<j),"z"]}else{k=~~(b/2);l=["M",i+k,g,"l",-b,0,0,-mmax(j-k,0),k,-mmin(k,j),k,mmin(k,j),k,"z"]}break;case"square":if(!d){l=["M",i,g+~~(j/2),"l",0,-j,b,0,0,j,"z"]}else{l=["M",i+~~(b/2),g,"l",1-b,0,0,-j,b-1,0,"z"]}break;case"soft":if(!d){a=mmin(b,Math.round(j/5));l=["M",i+0.5,g+0.5-~~(j/2),"l",b-a,0,"a",a,a,0,0,1,a,a,"l",0,j-a*2,"a",a,a,0,0,1,-a,a,"l",a-b,0,"z"]}else{a=mmin(Math.round(b/5),j);l=["M",i-~~(b/2),g,"l",0,a-j,"a",a,a,0,0,1,a,-a,"l",b-2*a,0,"a",a,a,0,0,1,a,a,"l",0,j-a,"z"]}}if(f){return l.join(",")}else{return c.path(l)}}function VBarchart(c,D,B,a,d,Q,v){v=v||{};var q=this,R=v.type||"square",n=parseFloat(v.gutter||"20%"),O=c.set(),w=c.set(),e=c.set(),t=c.set(),z=Math.max.apply(Math,Q),P=[],C=0,H=v.colors||q.colors,r=Q.length;if(Raphael.is(Q[0],"array")){z=[];C=r;r=0;for(var M=Q.length;M--;){w.push(c.set());z.push(Math.max.apply(Math,Q[M]));r=Math.max(r,Q[M].length)}if(v.stacked){for(var M=r;M--;){var l=0;for(var L=Q.length;L--;){l+=+Q[L][M]||0}P.push(l)}}for(var M=Q.length;M--;){if(Q[M].length<r){for(var L=r;L--;){Q[M].push(0)}}}z=Math.max.apply(Math,v.stacked?P:z)}z=(v.to)||z;var E=a/(r*(100+n)+n)*100,b=E*n/100,g=v.vgutter==null?20:v.vgutter,u=[],k=D+b,f=(d-2*g)/z;if(!v.stretch){b=Math.round(b);E=Math.floor(E)}!v.stacked&&(E/=C||1);for(var M=0;M<r;M++){u=[];for(var L=0;L<(C||1);L++){var N=Math.round((C?Q[L][M]:Q[M])*f),m=B+d-g-N,J=finger(Math.round(k+E/2),m+N,E,N,true,R,null,c).attr({stroke:"none",fill:H[C?L:M]});if(C){w[L].push(J)}else{w.push(J)}J.y=m;J.x=Math.round(k+E/2);J.w=E;J.h=N;J.value=C?Q[L][M]:Q[M];if(!v.stacked){k+=E}else{u.push(J)}}if(v.stacked){var K;t.push(K=c.rect(u[0].x-u[0].w/2,B,E,d).attr(q.shim));K.bars=c.set();var o=0;for(var G=u.length;G--;){u[G].toFront()}for(var G=0,p=u.length;G<p;G++){var J=u[G],A,N=(o+J.value)*f,I=finger(J.x,B+d-g-!!o*0.5,E,N,true,R,1,c);K.bars.push(J);o&&J.attr({path:I});J.h=N;J.y=B+d-g-!!o*0.5-N;e.push(A=c.rect(J.x-J.w/2,J.y,E,J.value*f).attr(q.shim));A.bar=J;A.value=J.value;o+=J.value}k+=E}k+=b}t.toFront();k=D+b;if(!v.stacked){for(var M=0;M<r;M++){for(var L=0;L<(C||1);L++){var A;e.push(A=c.rect(Math.round(k),B+g,E,d-g).attr(q.shim));A.bar=C?w[L][M]:w[M];A.value=A.bar.value;k+=E}k+=b}}O.label=function(V){V=V||[];this.labels=c.set();var s=this[0];for(var y=0;y<s.length;y++){var U=s[y],h=[];if(U){for(var x=0;x<U.length;x++){var S=U[x],T=S.getBBox();h.push(c.label(T.x,T.y,V[y][x]))}}}this.push(this.labels);return this};O.hover=function(i,h){t.hide();e.show();e.mouseover(i).mouseout(h);return this};O.hoverColumn=function(i,h){e.hide();t.show();h=h||function(){};t.mouseover(i).mouseout(h);return this};O.click=function(h){t.hide();e.show();e.click(h);return this};O.each=function(j){if(!Raphael.is(j,"function")){return this}for(var h=e.length;h--;){j.call(e[h])}return this};O.eachColumn=function(j){if(!Raphael.is(j,"function")){return this}for(var h=t.length;h--;){j.call(t[h])}return this};O.clickColumn=function(h){e.hide();t.show();t.click(h);return this};O.push(w,e,t);O.bars=w;O.covers=e;return O}function HBarchart(p,o,n,C,z,d,t){t=t||{};var b=this,f=t.type||"square",g=parseFloat(t.gutter||"20%"),v=p.set(),B=p.set(),k=p.set(),G=p.set(),O=Math.max.apply(Math,d),a=[],D=0,m=t.colors||b.colors,J=d.length;if(Raphael.is(d[0],"array")){O=[];D=J;J=0;for(var I=d.length;I--;){B.push(p.set());O.push(Math.max.apply(Math,d[I]));J=Math.max(J,d[I].length)}if(t.stacked){for(var I=J;I--;){var q=0;for(var H=d.length;H--;){q+=+d[H][I]||0}a.push(q)}}for(var I=d.length;I--;){if(d[I].length<J){for(var H=J;H--;){d[I].push(0)}}}O=Math.max.apply(Math,t.stacked?a:O)}O=(t.to)||O;var L=Math.floor(z/(J*(100+g)+g)*100),l=Math.floor(L*g/100),h=[],c=n+l,e=(C-1)/O;!t.stacked&&(L/=D||1);for(var I=0;I<J;I++){h=[];for(var H=0;H<(D||1);H++){var N=D?d[H][I]:d[I],K=finger(o,c+L/2,Math.round(N*e),L-1,false,f,null,p).attr({stroke:"none",fill:m[D?H:I]});if(D){B[H].push(K)}else{B.push(K)}K.x=o+Math.round(N*e);K.y=c+L/2;K.w=Math.round(N*e);K.h=L;K.value=+N;if(!t.stacked){c+=L}else{h.push(K)}}if(t.stacked){var r=p.rect(o,h[0].y-h[0].h/2,C,L).attr(b.shim);G.push(r);r.bars=p.set();var w=0;for(var u=h.length;u--;){h[u].toFront()}for(var u=0,E=h.length;u<E;u++){var K=h[u],M,N=Math.round((w+K.value)*e),A=finger(o,K.y,N,L-1,false,f,1,p);r.bars.push(K);w&&K.attr({path:A});K.w=N;K.x=o+N;k.push(M=p.rect(o+w*e,K.y-K.h/2,K.value*e,L).attr(b.shim));M.bar=K;w+=K.value}c+=L}c+=l}G.toFront();c=n+l;if(!t.stacked){for(var I=0;I<J;I++){for(var H=0;H<(D||1);H++){var M=p.rect(o,c,C,L).attr(b.shim);k.push(M);M.bar=D?B[H][I]:B[I];M.value=M.bar.value;c+=L}c+=l}}v.label=function(T,R){T=T||[];this.labels=p.set();for(var Q=0;Q<J;Q++){for(var P=0;P<D;P++){var y=Raphael.g.labelise(D?T[P]&&T[P][Q]:T[Q],D?d[P][Q]:d[Q],O),S=R?B[Q*(D||1)+P].x-L/2+3:o+5,x=R?"end":"start",s;this.labels.push(s=p.text(S,B[Q*(D||1)+P].y,y).attr(Raphael.g.txtattr).attr({"text-anchor":x}).insertBefore(k[0]));if(s.getBBox().x<o+5){s.attr({x:o+5,"text-anchor":"start"})}else{B[Q*(D||1)+P].label=s}}}return this};v.hover=function(j,i){G.hide();k.show();i=i||function(){};k.mouseover(j).mouseout(i);return this};v.hoverColumn=function(j,i){k.hide();G.show();i=i||function(){};G.mouseover(j).mouseout(i);return this};v.each=function(s){if(!Raphael.is(s,"function")){return this}for(var j=k.length;j--;){s.call(k[j])}return this};v.eachColumn=function(s){if(!Raphael.is(s,"function")){return this}for(var j=G.length;j--;){s.call(G[j])}return this};v.click=function(i){G.hide();k.show();k.click(i);return this};v.clickColumn=function(i){k.hide();G.show();G.click(i);return this};v.push(B,k,G);v.bars=B;v.covers=k;return v}var F=function(){};F.prototype=Raphael.g;HBarchart.prototype=VBarchart.prototype=new F;Raphael.fn.hbarchart=function(b,f,d,a,c,e){return new HBarchart(this,b,f,d,a,c,e)};Raphael.fn.barchart=function(b,f,d,a,c,e){return new VBarchart(this,b,f,d,a,c,e)};